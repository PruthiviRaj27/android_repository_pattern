<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Memory Game</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap');
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #1a202c;
      color: #e2e8f0;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 1rem;
    }
    .container1 {
      background-color: #2d3748;
      border-radius: 1.5rem;
      padding: 2rem;
      box-shadow: 0 10px 15px rgba(0, 0, 0, 0.2);
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      position: relative;
    }
    #game-board {
      display: grid;
      gap: 0.5rem;
      margin: auto;
      touch-action: none;
      width: 60%;
    }
    .card {
      background-color: #4a5568;
      border-radius: 0.75rem;
      position: relative;
      cursor: pointer;
      height: 0;
      padding-bottom: 100%;
      transition: transform 0.6s;
      transform-style: preserve-3d;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .card-inner {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: clamp(1rem, 4vw, 2rem);
      border-radius: 0.75rem;
    }
    .card-front {
      transform: rotateY(180deg);
    }
    .card-back {
      background-color: #4a5568;
    }
    .card.flipped {
      transform: rotateY(180deg);
    }
    .card.matched .card-back {
      background-color: #38a169;
      box-shadow: 0 0 10px #38a169;
    }
    .blank-cell {
      background-color: transparent;
      border: none;
      cursor: default;
    }
    .btn {
      background-color: #4a5568;
      color: #e2e8f0;
      padding: 0.75rem 1.5rem;
      border-radius: 9999px;
      font-weight: bold;
      transition: background-color 0.2s ease, transform 0.2s ease;
      box-shadow: 0 4px #2c323b;
    }
    .btn:hover {
      background-color: #6a768c;
      transform: translateY(-2px);
    }
    .btn:active {
      transform: translateY(1px);
      box-shadow: 0 2px #2c323b;
    }
    #message-modal, #ad-modal {
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      z-index: 50;
    }
    .modal-content {
      background-color: #2d3748;
      border-radius: 1rem;
      padding: 2rem;
      max-width: 400px;
      text-align: center;
    }
    .modal-btn {
      background-color: #63b3ed;
      color: #1a202c;
      padding: 0.5rem 1.5rem;
      border-radius: 9999px;
      font-weight: bold;
      transition: transform 0.2s;
    }
    .modal-btn:hover {
      transform: scale(1.05);
    }
  </style>
</head>
<body>
  <div class="container1">
    <div class="text-center">
      <h1 class="text-4xl font-bold mb-2">Memory Match</h1>
      <p class="text-gray-400">Find all the matching pairs!</p>
    </div>

    <div id="game-board"></div>

    <div class="flex sm:flex-row justify-center items-center gap-4">
      <div class="text-xl font-bold">Level: <span id="level-display">1</span></div>
      <div class="text-xl font-bold">Moves: <span id="moves-display">0</span></div>
    </div>

    <div class="flex sm:flex-row justify-center items-center gap-4">
      <button id="reset-btn" class="btn">Reset Game</button>
      <button id="hint-btn" class="btn">Get Hint</button>
    </div>
  </div>

  <!-- General Message Modal -->
  <div id="message-modal" class="fixed inset-0 hidden flex items-center justify-center p-4">
    <div class="modal-content">
      <h2 id="modal-title" class="text-3xl font-bold mb-4"></h2>
      <p id="modal-message" class="text-lg mb-6"></p>
      <button id="modal-ok-btn" class="modal-btn">Continue</button>
    </div>
  </div>

  <!-- Ad Simulation Modal -->
  <div id="ad-modal" class="fixed inset-0 hidden flex items-center justify-center p-4">
    <div class="modal-content">
      <h2 class="text-3xl font-bold mb-4">Rewarded Ad</h2>
      <p class="text-lg mb-6">Thank you for watching! Your hint will be revealed shortly.</p>
      <button id="ad-ok-btn" class="modal-btn">Continue</button>
    </div>
  </div>

  <script>
    const emojis = ['😊', '😂', '👍', '🚀', '🌟', '❤️', '🎮', '💡', '🔥', '🎉', '🐱', '🐶', '🍕', '🌮', '🌈', '🍦', '🎈', '🎁', '👑', '💎', '💰', '🔑', '🔔', '🎶', '🌺', '🌲'];
    
    const levels = [
      { pairs: 4, gridCols: 3, blankIndex: 4 },
      { pairs: 4, gridCols: 3, blankIndex: 4 },
      { pairs: 4, gridCols: 3, blankIndex: 4 },
      { pairs: 8, gridCols: 4, blankIndex: -1 },
      { pairs: 8, gridCols: 4, blankIndex: -1 },
      { pairs: 8, gridCols: 4, blankIndex: -1 },
      { pairs: 12, gridCols: 5, blankIndex: 12 },
      { pairs: 12, gridCols: 5, blankIndex: 12 },
      { pairs: 12, gridCols: 5, blankIndex: 12 },
    ];

    let gameBoard = document.getElementById('game-board');
    let levelDisplay = document.getElementById('level-display');
    let movesDisplay = document.getElementById('moves-display');
    let resetBtn = document.getElementById('reset-btn');
    let hintBtn = document.getElementById('hint-btn');
    let messageModal = document.getElementById('message-modal');
    let modalTitle = document.getElementById('modal-title');
    let modalMessage = document.getElementById('modal-message');
    let modalOkBtn = document.getElementById('modal-ok-btn');
    let adModal = document.getElementById('ad-modal');
    let adOkBtn = document.getElementById('ad-ok-btn');

    let cards = [];
    let flippedCards = [];
    let matchedCards = 0;
    let moves = 0;
    let isProcessing = false;
    let currentLevel = 0;

    function shuffle(array) {
      let currentIndex = array.length, randomIndex;
      while (currentIndex !== 0) {
        randomIndex = Math.floor(Math.random() * currentIndex);
        currentIndex--;
        [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
      }
      return array;
    }

    function createBoard() {
      const levelConfig = levels[currentLevel];
      const numPairs = levelConfig.pairs;
      const gridCols = levelConfig.gridCols;
      const blankIndex = levelConfig.blankIndex;

      cards = [];
      const selectedEmojis = shuffle([...emojis]).slice(0, numPairs);
      for (let i = 0; i < numPairs; i++) {
        cards.push(selectedEmojis[i]);
        cards.push(selectedEmojis[i]);
      }
      shuffle(cards);

      gameBoard.innerHTML = '';
      gameBoard.style.gridTemplateColumns = `repeat(${gridCols}, 1fr)`;

      let cardIndex = 0;
      for (let i = 0; i < gridCols * gridCols; i++) {
        if (i === blankIndex) {
          const blankEl = document.createElement('div');
          blankEl.classList.add('blank-cell');
          gameBoard.appendChild(blankEl);
        } else {
          const cardEl = document.createElement('div');
          cardEl.classList.add('card');
          cardEl.dataset.index = cardIndex;

          const cardFront = document.createElement('div');
          cardFront.classList.add('card-inner', 'card-front');
          cardFront.textContent = cards[cardIndex];

          const cardBack = document.createElement('div');
          cardBack.classList.add('card-inner', 'card-back');

          cardEl.appendChild(cardFront);
          cardEl.appendChild(cardBack);
          
          cardEl.addEventListener('click', handleCardClick);
          gameBoard.appendChild(cardEl);
          cardIndex++;
        }
      }
    }

    function handleCardClick(event) {
      if (isProcessing) return;

      const card = event.target.closest('.card');
      if (!card || card.classList.contains('flipped') || card.classList.contains('matched')) return;

      card.classList.add('flipped');
      flippedCards.push(card);

      if (flippedCards.length === 2) {
        isProcessing = true;
        moves++;
        movesDisplay.textContent = moves;

        const [card1, card2] = flippedCards;
        const emoji1 = card1.querySelector('.card-front').textContent;
        const emoji2 = card2.querySelector('.card-front').textContent;

        if (emoji1 === emoji2) {
          card1.classList.add('matched');
          card2.classList.add('matched');
          matchedCards += 2;
          flippedCards = [];
          isProcessing = false;
          checkWin();
        } else {
          setTimeout(() => {
            card1.classList.remove('flipped');
            card2.classList.remove('flipped');
            flippedCards = [];
            isProcessing = false;
          }, 1000);
        }
      }
    }

    function checkWin() {
      const numPairs = levels[currentLevel].pairs;
      if (matchedCards === numPairs * 2) {
        if (currentLevel < levels.length - 1) {
          showModal("Level Complete!", `You completed the level in ${moves} moves!`);
        } else {
          showModal("Congratulations!", `You have completed all levels!`);
        }
      }
    }

    function showModal(title, message) {
      modalTitle.textContent = title;
      modalMessage.textContent = message;
      modalOkBtn.textContent = (currentLevel < levels.length - 1) ? "Next Level" : "Play Again";
      messageModal.classList.remove('hidden');
    }

    function resetGame() {
      flippedCards = [];
      matchedCards = 0;
      moves = 0;
      movesDisplay.textContent = 0;
      isProcessing = false;
      currentLevel = 0;
      levelDisplay.textContent = currentLevel + 1;
      createBoard();
    }

    function nextLevel() {
      if (currentLevel < levels.length - 1) {
        currentLevel++;
      } else {
        currentLevel = 0;
      }
      flippedCards = [];
      matchedCards = 0;
      moves = 0;
      movesDisplay.textContent = 0;
      isProcessing = false;
      levelDisplay.textContent = currentLevel + 1;
      createBoard();
    }

    function showHint() {
      if (isProcessing) return;

      const cardsOnBoard = Array.from(document.querySelectorAll('.card:not(.matched)'));
      const unflippedCards = cardsOnBoard.filter(card => !card.classList.contains('flipped'));
      if (unflippedCards.length < 2) return;

      let pairFound = false;
      while (!pairFound) {
        const card1 = unflippedCards[Math.floor(Math.random() * unflippedCards.length)];
        const card1Emoji = card1.querySelector('.card-front').textContent;

        const matchingCard = unflippedCards.find(card => card !== card1 && card.querySelector('.card-front').textContent === card1Emoji);
        
        if (matchingCard) {
          isProcessing = true;
          pairFound = true;
          card1.classList.add('flipped');
          matchingCard.classList.add('flipped');

          setTimeout(() => {
            card1.classList.remove('flipped');
            matchingCard.classList.remove('flipped');
            isProcessing = false;
          }, 2000);
        }
      }
    }

    window.onload = function() {
      createBoard();
      resetBtn.addEventListener('click', resetGame);
      modalOkBtn.addEventListener('click', () => {
        messageModal.classList.add('hidden');
        if (modalTitle.textContent === "Level Complete!") {
          nextLevel();
        } else {
          resetGame();
        }
      });

      hintBtn.addEventListener('click', () => {
        adModal.classList.remove('hidden');
      });

      adOkBtn.addEventListener('click', () => {
        adModal.classList.add('hidden');
        showHint();
      });
    };
  </script>
</body>
</html>
